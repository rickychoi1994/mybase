(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{256:function(t,s,a){"use strict";a.r(s);var v=a(17),e=Object(v.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"数据卷"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据卷"}},[t._v("#")]),t._v(" 数据卷")]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("思考")]),t._v(" "),a("ul",[a("li",[t._v("Docker 容器删除后，在容器中产生的数据还在吗？")]),t._v(" "),a("li",[t._v("Docker 容器和外部机器可以直接交换文件吗？")]),t._v(" "),a("li",[t._v("容器之间如何进行数据交互？")])])]),t._v(" "),a("h2",{attrs:{id:"概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#概念"}},[t._v("#")]),t._v(" 概念")]),t._v(" "),a("ul",[a("li",[t._v("数据卷是宿主机终端俄一个目录或文件")]),t._v(" "),a("li",[t._v("当容器目录和数据卷目录绑定后，对方的修改会立即同步")]),t._v(" "),a("li",[t._v("一个数据卷可以被多个容器同时挂载")]),t._v(" "),a("li",[t._v("一个容器也可以挂载多个数据卷")])]),t._v(" "),a("h2",{attrs:{id:"作用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#作用"}},[t._v("#")]),t._v(" 作用")]),t._v(" "),a("ul",[a("li",[t._v("容器数据持久化")]),t._v(" "),a("li",[t._v("外部机器和容器间接通信")]),t._v(" "),a("li",[t._v("容器之间的数据交换")])]),t._v(" "),a("h2",{attrs:{id:"配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置"}},[t._v("#")]),t._v(" 配置")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 创建启动容器时，使用-v参数设置数据卷")]),t._v("\ndocker run "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". -v 宿主机目录"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("文件"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(":容器内目录"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("文件"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 注意事项:")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#    1. 目录必须是绝对路径")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#    2. 如果目录不存在，自动创建")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#    3. 可以挂载多个数据卷")]),t._v("\n")])])]),a("h2",{attrs:{id:"数据卷容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据卷容器"}},[t._v("#")]),t._v(" 数据卷容器")]),t._v(" "),a("p",[t._v("多容器进行数据交换:")]),t._v(" "),a("ul",[a("li",[t._v("多个容器挂载同一个数据卷 (容器多的话操作麻烦，对于数据的保存持久化和恢复不方便)")]),t._v(" "),a("li",[a("strong",[t._v("数据卷容器")])])]),t._v(" "),a("img",{attrs:{src:t.$withBase("/data.png"),alt:"数据卷"}}),t._v(" "),a("p",[t._v("创建一个容器"),a("code",[t._v("c3")]),t._v("并挂载宿主机的一个数据卷，之后把"),a("code",[t._v("c1")]),t._v("和"),a("code",[t._v("c2")]),t._v("挂载到"),a("code",[t._v("c3")]),t._v("上，相当于"),a("code",[t._v("c1")]),t._v("、"),a("code",[t._v("c2")]),t._v("和"),a("code",[t._v("c3")]),t._v("都挂载到了同一个数据卷上，这就意味着"),a("code",[t._v("c1")]),t._v("、"),a("code",[t._v("c2")]),t._v("、"),a("code",[t._v("c3")]),t._v("可以相互的数据传输和通讯，即使"),a("code",[t._v("c3")]),t._v("出现了问题，"),a("code",[t._v("c1")]),t._v("和"),a("code",[t._v("c2")]),t._v("依然可以通过宿主机的数据卷进行通讯。"),a("code",[t._v("c3")]),t._v("就被成为数据卷容器。")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 创建启动c3数据卷容器，使用-v参数设置数据卷")]),t._v("\ndocker run -it --name c3 -v /volume "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 注意")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 上面命令的 /volume 是容器目录，并不是宿主机数据卷目录，但是宿主机会自动分配一个目录当作数据卷")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 创建启动c1、c2容器，使用--volumes-from参数设置数据卷")]),t._v("\ndocker run -it --name c1 --volumes-from c3 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\ndocker run -it --name c2 --volumes-from c3 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);